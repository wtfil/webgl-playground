!function(r){var t={};function e(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var o in r)e.d(n,o,function(t){return r[t]}.bind(null,o));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=2)}([function(r,t,e){"use strict";e.d(t,"b",function(){return n}),e.d(t,"a",function(){return o}),e.d(t,"c",function(){return i});var n=1e-6,o="undefined"!=typeof Float32Array?Float32Array:Array,i=Math.random;Math.PI},function(r,t,e){"use strict";e.r(t),e.d(t,"create",function(){return o}),e.d(t,"clone",function(){return i}),e.d(t,"length",function(){return a}),e.d(t,"fromValues",function(){return u}),e.d(t,"copy",function(){return s}),e.d(t,"set",function(){return c}),e.d(t,"add",function(){return f}),e.d(t,"subtract",function(){return l}),e.d(t,"multiply",function(){return d}),e.d(t,"divide",function(){return m}),e.d(t,"ceil",function(){return h}),e.d(t,"floor",function(){return v}),e.d(t,"min",function(){return p}),e.d(t,"max",function(){return g}),e.d(t,"round",function(){return M}),e.d(t,"scale",function(){return b}),e.d(t,"scaleAndAdd",function(){return T}),e.d(t,"distance",function(){return w}),e.d(t,"squaredDistance",function(){return x}),e.d(t,"squaredLength",function(){return E}),e.d(t,"negate",function(){return _}),e.d(t,"inverse",function(){return R}),e.d(t,"normalize",function(){return y}),e.d(t,"dot",function(){return P}),e.d(t,"cross",function(){return C}),e.d(t,"lerp",function(){return F}),e.d(t,"hermite",function(){return A}),e.d(t,"bezier",function(){return L}),e.d(t,"random",function(){return S}),e.d(t,"transformMat4",function(){return D}),e.d(t,"transformMat3",function(){return U}),e.d(t,"transformQuat",function(){return B}),e.d(t,"rotateX",function(){return I}),e.d(t,"rotateY",function(){return O}),e.d(t,"rotateZ",function(){return N}),e.d(t,"angle",function(){return j}),e.d(t,"zero",function(){return X}),e.d(t,"str",function(){return q}),e.d(t,"exactEquals",function(){return V}),e.d(t,"equals",function(){return z}),e.d(t,"sub",function(){return G}),e.d(t,"mul",function(){return H}),e.d(t,"div",function(){return W}),e.d(t,"dist",function(){return Y}),e.d(t,"sqrDist",function(){return Z}),e.d(t,"len",function(){return Q}),e.d(t,"sqrLen",function(){return J}),e.d(t,"forEach",function(){return $});var n=e(0);function o(){var r=new n.a(3);return n.a!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function i(r){var t=new n.a(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function a(r){var t=r[0],e=r[1],n=r[2];return Math.sqrt(t*t+e*e+n*n)}function u(r,t,e){var o=new n.a(3);return o[0]=r,o[1]=t,o[2]=e,o}function s(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function c(r,t,e,n){return r[0]=t,r[1]=e,r[2]=n,r}function f(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function l(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function d(r,t,e){return r[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r}function m(r,t,e){return r[0]=t[0]/e[0],r[1]=t[1]/e[1],r[2]=t[2]/e[2],r}function h(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r}function v(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r}function p(r,t,e){return r[0]=Math.min(t[0],e[0]),r[1]=Math.min(t[1],e[1]),r[2]=Math.min(t[2],e[2]),r}function g(r,t,e){return r[0]=Math.max(t[0],e[0]),r[1]=Math.max(t[1],e[1]),r[2]=Math.max(t[2],e[2]),r}function M(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r}function b(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r}function T(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r}function w(r,t){var e=t[0]-r[0],n=t[1]-r[1],o=t[2]-r[2];return Math.sqrt(e*e+n*n+o*o)}function x(r,t){var e=t[0]-r[0],n=t[1]-r[1],o=t[2]-r[2];return e*e+n*n+o*o}function E(r){var t=r[0],e=r[1],n=r[2];return t*t+e*e+n*n}function _(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r}function R(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r}function y(r,t){var e=t[0],n=t[1],o=t[2],i=e*e+n*n+o*o;return i>0&&(i=1/Math.sqrt(i)),r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r}function P(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function C(r,t,e){var n=t[0],o=t[1],i=t[2],a=e[0],u=e[1],s=e[2];return r[0]=o*s-i*u,r[1]=i*a-n*s,r[2]=n*u-o*a,r}function F(r,t,e,n){var o=t[0],i=t[1],a=t[2];return r[0]=o+n*(e[0]-o),r[1]=i+n*(e[1]-i),r[2]=a+n*(e[2]-a),r}function A(r,t,e,n,o,i){var a=i*i,u=a*(2*i-3)+1,s=a*(i-2)+i,c=a*(i-1),f=a*(3-2*i);return r[0]=t[0]*u+e[0]*s+n[0]*c+o[0]*f,r[1]=t[1]*u+e[1]*s+n[1]*c+o[1]*f,r[2]=t[2]*u+e[2]*s+n[2]*c+o[2]*f,r}function L(r,t,e,n,o,i){var a=1-i,u=a*a,s=i*i,c=u*a,f=3*i*u,l=3*s*a,d=s*i;return r[0]=t[0]*c+e[0]*f+n[0]*l+o[0]*d,r[1]=t[1]*c+e[1]*f+n[1]*l+o[1]*d,r[2]=t[2]*c+e[2]*f+n[2]*l+o[2]*d,r}function S(r,t){t=t||1;var e=2*n.c()*Math.PI,o=2*n.c()-1,i=Math.sqrt(1-o*o)*t;return r[0]=Math.cos(e)*i,r[1]=Math.sin(e)*i,r[2]=o*t,r}function D(r,t,e){var n=t[0],o=t[1],i=t[2],a=e[3]*n+e[7]*o+e[11]*i+e[15];return a=a||1,r[0]=(e[0]*n+e[4]*o+e[8]*i+e[12])/a,r[1]=(e[1]*n+e[5]*o+e[9]*i+e[13])/a,r[2]=(e[2]*n+e[6]*o+e[10]*i+e[14])/a,r}function U(r,t,e){var n=t[0],o=t[1],i=t[2];return r[0]=n*e[0]+o*e[3]+i*e[6],r[1]=n*e[1]+o*e[4]+i*e[7],r[2]=n*e[2]+o*e[5]+i*e[8],r}function B(r,t,e){var n=e[0],o=e[1],i=e[2],a=e[3],u=t[0],s=t[1],c=t[2],f=o*c-i*s,l=i*u-n*c,d=n*s-o*u,m=o*d-i*l,h=i*f-n*d,v=n*l-o*f,p=2*a;return f*=p,l*=p,d*=p,m*=2,h*=2,v*=2,r[0]=u+f+m,r[1]=s+l+h,r[2]=c+d+v,r}function I(r,t,e,n){var o=[],i=[];return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],i[0]=o[0],i[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),i[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),r[0]=i[0]+e[0],r[1]=i[1]+e[1],r[2]=i[2]+e[2],r}function O(r,t,e,n){var o=[],i=[];return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],i[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),i[1]=o[1],i[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),r[0]=i[0]+e[0],r[1]=i[1]+e[1],r[2]=i[2]+e[2],r}function N(r,t,e,n){var o=[],i=[];return o[0]=t[0]-e[0],o[1]=t[1]-e[1],o[2]=t[2]-e[2],i[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),i[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),i[2]=o[2],r[0]=i[0]+e[0],r[1]=i[1]+e[1],r[2]=i[2]+e[2],r}function j(r,t){var e=u(r[0],r[1],r[2]),n=u(t[0],t[1],t[2]);y(e,e),y(n,n);var o=P(e,n);return o>1?0:o<-1?Math.PI:Math.acos(o)}function X(r){return r[0]=0,r[1]=0,r[2]=0,r}function q(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function V(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]}function z(r,t){var e=r[0],o=r[1],i=r[2],a=t[0],u=t[1],s=t[2];return Math.abs(e-a)<=n.b*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(o-u)<=n.b*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-s)<=n.b*Math.max(1,Math.abs(i),Math.abs(s))}var k,G=l,H=d,W=m,Y=w,Z=x,Q=a,J=E,$=(k=o(),function(r,t,e,n,o,i){var a,u;for(t||(t=3),e||(e=0),u=n?Math.min(n*t+e,r.length):r.length,a=e;a<u;a+=t)k[0]=r[a],k[1]=r[a+1],k[2]=r[a+2],o(k,k,i),r[a]=k[0],r[a+1]=k[1],r[a+2]=k[2];return r})},function(r,t,e){"use strict";var n=this&&this.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)t.indexOf(n[o])<0&&(e[n[o]]=r[n[o]])}return e},o=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(t,"__esModule",{value:!0});const i=e(3),a=e(1),u=o(e(4)),s=o(e(5)),c=o(e(6)),f=o(e(7)),l=o(e(8)),d=o(e(9)),m=e(10),h=e(11),v=e(13),p=e(14),g=e(15),M=e(16);window.addEventListener("load",async function(){const r=document.querySelector("canvas");r.width=T,r.height=w;const t=r.getContext("experimental-webgl");if(!t)return void console.warn("Can not create webgl context");const e=document.querySelector("[data-properties]"),o=M.createProgram(t,u.default,s.default),i=M.createProgram(t,c.default,f.default),b=M.createProgram(t,l.default,d.default),R=await m.createTerrain("heightmaps/mountain2.png",500/E,E),P=R&&_(t,{arrays:R}),C=await M.loadTexture(t,"textures/dudvmap.png"),F=await M.loadTexture(t,"textures/normalmap.png"),[A,L]=M.createFramebufferAndTexture(t,x,x),[S,D]=M.createFramebufferAndTexture(t,x,x),U=_(t,{arrays:v.createWater(),framebuffers:{refraction:L,reflection:D},textures:{dudv:C,normalMap:F,refraction:A,reflection:S}}),B=_(t,{arrays:p.createSun()});if(!(U&&i&&o&&P&&b))return;const I=g.initProperties();h.initControls(r).on("toggleRenderWater",()=>{I.renderWater=!I.renderWater,O()}).on("toggleRenderTerrain",()=>{I.renderTerrain=!I.renderTerrain,O()}).on("toggleRefraction",()=>{I.useRefraction=!I.useRefraction,O()}).on("toggleReflection",()=>{I.useReflection=!I.useReflection,O()}).on("toggleRenderSun",()=>{I.renderSun=!I.renderSun,O()}).on("zoom",r=>{const{cameraPosition:t,center:e}=I,n=a.create(),o=a.distance(e,t),i=M.inRange(o+r.dy,50,1e3);a.sub(n,t,e),a.scale(n,n,i/o),a.add(t,e,n),O()}).on("move",r=>{const t=a.fromValues(r.dx,r.dy,0),{cameraPosition:e,center:n}=I;a.add(e,e,t),a.add(n,n,t),O()}).on("moveCamera",r=>{const{cameraPosition:t,center:e}=I,n=a.distance(e,t),o=a.create();a.sub(o,t,e);const i=a.clone(o);i[2]=0;const u=M.inRange(a.angle(o,i)+.01*r.dy,.1,Math.PI/3);i[2]=n*Math.sin(u),a.copy(o,i),a.rotateZ(o,o,[0,0,0],.01*r.dx),a.add(t,e,o),O()});const O=()=>{g.renderProperties(e,I)};(function r(){const e=Date.now()-I.start;const u=p.getSunPosition(e),{sunPosition:s}=u,c=n(u,["sunPosition"]);const f=a.create();a.negate(f,s);Object.assign(I,Object.assign({time:e,sunPosition:s,directionalLightVector:f},c));O();y({gl:t,terrainProgram:o,waterProgram:i,sunProgram:b,properties:I,terrain:P,water:U,sun:B});requestAnimationFrame(r)})(),O()});const b=Math.min(window.innerWidth,window.innerHeight),T=b,w=b,x=2*b,E=5;function _(r,t){const{arrays:e,textures:n={},framebuffers:o={}}=t;return{buffers:{position:M.createBuffer(r,r.ARRAY_BUFFER,new Float32Array(e.position)),colors:M.createBuffer(r,r.ARRAY_BUFFER,new Float32Array(e.colors)),indices:M.createBuffer(r,r.ELEMENT_ARRAY_BUFFER,new Uint16Array(e.indices)),normal:M.createBuffer(r,r.ARRAY_BUFFER,new Float32Array(e.normals)),texture:M.createBuffer(r,r.ARRAY_BUFFER,new Float32Array(e.texture))},textures:n,framebuffers:o,size:e.indices.length}}function R(r,t=!1,e=2e3){const n=i.create(),o=i.create(),u=i.create();let s;return t?(s=a.clone(r.cameraPosition),a.sub(s,s,r.center),s[2]=-s[2],a.add(s,s,r.center)):s=r.cameraPosition,i.perspective(n,45*Math.PI/180,T/w,.1,e),i.lookAt(o,s,r.center,[0,0,1]),{model:u,projection:n,view:o}}function y(r){const t=50/E,{gl:e,terrainProgram:n,waterProgram:o,sunProgram:a,properties:u,terrain:s,water:c,sun:f}=r,l=(r,o)=>{if(!u.renderTerrain){return}const{projection:a,model:c,view:f}=R(u,o);if(o){i.translate(c,c,[0,0,r*t*2])}e.useProgram(n.program);M.bindBuffer(e,s.buffers.position,n.attributes.position,3);M.bindBuffer(e,s.buffers.normal,n.attributes.normal,3);M.bindBuffer(e,s.buffers.colors,n.attributes.colors,4);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s.buffers.indices);e.uniformMatrix4fv(n.uniforms.projection,false,a);e.uniformMatrix4fv(n.uniforms.model,false,c);e.uniformMatrix4fv(n.uniforms.view,false,f);e.uniform3fv(n.uniforms.directionalLightVector,u.directionalLightVector);e.uniform1f(n.uniforms.clipZ,t);e.uniform1f(n.uniforms.clipLevel,r);e.enable(e.BLEND);e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);e.drawElements(e.TRIANGLES,s.size,e.UNSIGNED_SHORT,0);e.disable(e.BLEND)},d=()=>{e.bindFramebuffer(e.FRAMEBUFFER,c.framebuffers.refraction),e.viewport(0,0,x,x),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),l(1,false),e.bindFramebuffer(e.FRAMEBUFFER,null)},m=()=>{e.bindFramebuffer(e.FRAMEBUFFER,c.framebuffers.reflection),e.viewport(0,0,x,x),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),l(-1,true),v(),e.bindFramebuffer(e.FRAMEBUFFER,null)},h=()=>{if(!u.renderWater){return}const{view:r,model:n,projection:a}=R(u);i.translate(n,n,[0,0,t]),i.scale(n,n,[x,x,1]),e.useProgram(o.program),M.bindBuffer(e,c.buffers.position,o.attributes.position,3),M.bindBuffer(e,c.buffers.texture,o.attributes.textureCoord,2),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c.buffers.indices),e.uniform1f(o.uniforms.dudvOffset,u.time/1e3*.06%1),e.uniform1i(o.uniforms.useRefraction,Number(u.useRefraction)),e.uniform1i(o.uniforms.useReflection,Number(u.useReflection)),e.uniform3fv(o.uniforms.center,u.center),e.uniform3fv(o.uniforms.cameraPosition,u.cameraPosition),e.uniform3fv(o.uniforms.directionalLightVector,u.directionalLightVector),e.uniformMatrix4fv(o.uniforms.projection,false,a),e.uniformMatrix4fv(o.uniforms.model,false,n),e.uniformMatrix4fv(o.uniforms.view,false,r),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,c.textures.dudv),e.uniform1i(o.uniforms.dudvTexture,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,c.textures.normalMap),e.uniform1i(o.uniforms.normalMapTexture,1),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,c.textures.refraction),e.uniform1i(o.uniforms.refractionTexture,2),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,c.textures.reflection),e.uniform1i(o.uniforms.reflectionTexture,3),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.drawElements(e.TRIANGLES,c.size,e.UNSIGNED_SHORT,0),e.disable(e.BLEND)};function v(){if(!u.renderSun){return}const r=2e3;const{projection:t,view:n,model:o}=R(u,false,r*2);i.scale(o,o,[r,r,r]);e.useProgram(a.program);M.bindBuffer(e,f.buffers.position,a.attributes.position,3);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f.buffers.indices);e.uniform1f(a.uniforms.domeRadius,r);e.uniform3fv(a.uniforms.sunPosition,u.sunPosition);e.uniformMatrix4fv(a.uniforms.projection,false,t);e.uniformMatrix4fv(a.uniforms.view,false,n);e.uniformMatrix4fv(a.uniforms.model,false,o);e.enable(e.BLEND);e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);e.drawElements(e.TRIANGLES,f.size,e.UNSIGNED_SHORT,0);e.disable(e.BLEND)}if(e.clearDepth(1),e.clearColor(.53,.8,.98,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),u.renderWater){m();d()}e.viewport(0,0,T,w),v(),l(0,false),h()}},function(r,t,e){"use strict";e.r(t),e.d(t,"create",function(){return o}),e.d(t,"clone",function(){return i}),e.d(t,"copy",function(){return a}),e.d(t,"fromValues",function(){return u}),e.d(t,"set",function(){return s}),e.d(t,"identity",function(){return c}),e.d(t,"transpose",function(){return f}),e.d(t,"invert",function(){return l}),e.d(t,"adjoint",function(){return d}),e.d(t,"determinant",function(){return m}),e.d(t,"multiply",function(){return h}),e.d(t,"translate",function(){return v}),e.d(t,"scale",function(){return p}),e.d(t,"rotate",function(){return g}),e.d(t,"rotateX",function(){return M}),e.d(t,"rotateY",function(){return b}),e.d(t,"rotateZ",function(){return T}),e.d(t,"fromTranslation",function(){return w}),e.d(t,"fromScaling",function(){return x}),e.d(t,"fromRotation",function(){return E}),e.d(t,"fromXRotation",function(){return _}),e.d(t,"fromYRotation",function(){return R}),e.d(t,"fromZRotation",function(){return y}),e.d(t,"fromRotationTranslation",function(){return P}),e.d(t,"fromQuat2",function(){return C}),e.d(t,"getTranslation",function(){return F}),e.d(t,"getScaling",function(){return A}),e.d(t,"getRotation",function(){return L}),e.d(t,"fromRotationTranslationScale",function(){return S}),e.d(t,"fromRotationTranslationScaleOrigin",function(){return D}),e.d(t,"fromQuat",function(){return U}),e.d(t,"frustum",function(){return B}),e.d(t,"perspective",function(){return I}),e.d(t,"perspectiveFromFieldOfView",function(){return O}),e.d(t,"ortho",function(){return N}),e.d(t,"lookAt",function(){return j}),e.d(t,"targetTo",function(){return X}),e.d(t,"str",function(){return q}),e.d(t,"frob",function(){return V}),e.d(t,"add",function(){return z}),e.d(t,"subtract",function(){return k}),e.d(t,"multiplyScalar",function(){return G}),e.d(t,"multiplyScalarAndAdd",function(){return H}),e.d(t,"exactEquals",function(){return W}),e.d(t,"equals",function(){return Y}),e.d(t,"mul",function(){return Z}),e.d(t,"sub",function(){return Q});var n=e(0);function o(){var r=new n.a(16);return n.a!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function i(r){var t=new n.a(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function a(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function u(r,t,e,o,i,a,u,s,c,f,l,d,m,h,v,p){var g=new n.a(16);return g[0]=r,g[1]=t,g[2]=e,g[3]=o,g[4]=i,g[5]=a,g[6]=u,g[7]=s,g[8]=c,g[9]=f,g[10]=l,g[11]=d,g[12]=m,g[13]=h,g[14]=v,g[15]=p,g}function s(r,t,e,n,o,i,a,u,s,c,f,l,d,m,h,v,p){return r[0]=t,r[1]=e,r[2]=n,r[3]=o,r[4]=i,r[5]=a,r[6]=u,r[7]=s,r[8]=c,r[9]=f,r[10]=l,r[11]=d,r[12]=m,r[13]=h,r[14]=v,r[15]=p,r}function c(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function f(r,t){if(r===t){var e=t[1],n=t[2],o=t[3],i=t[6],a=t[7],u=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=n,r[9]=i,r[11]=t[14],r[12]=o,r[13]=a,r[14]=u}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function l(r,t){var e=t[0],n=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],m=t[11],h=t[12],v=t[13],p=t[14],g=t[15],M=e*u-n*a,b=e*s-o*a,T=e*c-i*a,w=n*s-o*u,x=n*c-i*u,E=o*c-i*s,_=f*v-l*h,R=f*p-d*h,y=f*g-m*h,P=l*p-d*v,C=l*g-m*v,F=d*g-m*p,A=M*F-b*C+T*P+w*y-x*R+E*_;return A?(A=1/A,r[0]=(u*F-s*C+c*P)*A,r[1]=(o*C-n*F-i*P)*A,r[2]=(v*E-p*x+g*w)*A,r[3]=(d*x-l*E-m*w)*A,r[4]=(s*y-a*F-c*R)*A,r[5]=(e*F-o*y+i*R)*A,r[6]=(p*T-h*E-g*b)*A,r[7]=(f*E-d*T+m*b)*A,r[8]=(a*C-u*y+c*_)*A,r[9]=(n*y-e*C-i*_)*A,r[10]=(h*x-v*T+g*M)*A,r[11]=(l*T-f*x-m*M)*A,r[12]=(u*R-a*P-s*_)*A,r[13]=(e*P-n*R+o*_)*A,r[14]=(v*b-h*w-p*M)*A,r[15]=(f*w-l*b+d*M)*A,r):null}function d(r,t){var e=t[0],n=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],m=t[11],h=t[12],v=t[13],p=t[14],g=t[15];return r[0]=u*(d*g-m*p)-l*(s*g-c*p)+v*(s*m-c*d),r[1]=-(n*(d*g-m*p)-l*(o*g-i*p)+v*(o*m-i*d)),r[2]=n*(s*g-c*p)-u*(o*g-i*p)+v*(o*c-i*s),r[3]=-(n*(s*m-c*d)-u*(o*m-i*d)+l*(o*c-i*s)),r[4]=-(a*(d*g-m*p)-f*(s*g-c*p)+h*(s*m-c*d)),r[5]=e*(d*g-m*p)-f*(o*g-i*p)+h*(o*m-i*d),r[6]=-(e*(s*g-c*p)-a*(o*g-i*p)+h*(o*c-i*s)),r[7]=e*(s*m-c*d)-a*(o*m-i*d)+f*(o*c-i*s),r[8]=a*(l*g-m*v)-f*(u*g-c*v)+h*(u*m-c*l),r[9]=-(e*(l*g-m*v)-f*(n*g-i*v)+h*(n*m-i*l)),r[10]=e*(u*g-c*v)-a*(n*g-i*v)+h*(n*c-i*u),r[11]=-(e*(u*m-c*l)-a*(n*m-i*l)+f*(n*c-i*u)),r[12]=-(a*(l*p-d*v)-f*(u*p-s*v)+h*(u*d-s*l)),r[13]=e*(l*p-d*v)-f*(n*p-o*v)+h*(n*d-o*l),r[14]=-(e*(u*p-s*v)-a*(n*p-o*v)+h*(n*s-o*u)),r[15]=e*(u*d-s*l)-a*(n*d-o*l)+f*(n*s-o*u),r}function m(r){var t=r[0],e=r[1],n=r[2],o=r[3],i=r[4],a=r[5],u=r[6],s=r[7],c=r[8],f=r[9],l=r[10],d=r[11],m=r[12],h=r[13],v=r[14],p=r[15];return(t*a-e*i)*(l*p-d*v)-(t*u-n*i)*(f*p-d*h)+(t*s-o*i)*(f*v-l*h)+(e*u-n*a)*(c*p-d*m)-(e*s-o*a)*(c*v-l*m)+(n*s-o*u)*(c*h-f*m)}function h(r,t,e){var n=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=t[9],m=t[10],h=t[11],v=t[12],p=t[13],g=t[14],M=t[15],b=e[0],T=e[1],w=e[2],x=e[3];return r[0]=b*n+T*u+w*l+x*v,r[1]=b*o+T*s+w*d+x*p,r[2]=b*i+T*c+w*m+x*g,r[3]=b*a+T*f+w*h+x*M,b=e[4],T=e[5],w=e[6],x=e[7],r[4]=b*n+T*u+w*l+x*v,r[5]=b*o+T*s+w*d+x*p,r[6]=b*i+T*c+w*m+x*g,r[7]=b*a+T*f+w*h+x*M,b=e[8],T=e[9],w=e[10],x=e[11],r[8]=b*n+T*u+w*l+x*v,r[9]=b*o+T*s+w*d+x*p,r[10]=b*i+T*c+w*m+x*g,r[11]=b*a+T*f+w*h+x*M,b=e[12],T=e[13],w=e[14],x=e[15],r[12]=b*n+T*u+w*l+x*v,r[13]=b*o+T*s+w*d+x*p,r[14]=b*i+T*c+w*m+x*g,r[15]=b*a+T*f+w*h+x*M,r}function v(r,t,e){var n,o,i,a,u,s,c,f,l,d,m,h,v=e[0],p=e[1],g=e[2];return t===r?(r[12]=t[0]*v+t[4]*p+t[8]*g+t[12],r[13]=t[1]*v+t[5]*p+t[9]*g+t[13],r[14]=t[2]*v+t[6]*p+t[10]*g+t[14],r[15]=t[3]*v+t[7]*p+t[11]*g+t[15]):(n=t[0],o=t[1],i=t[2],a=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],d=t[9],m=t[10],h=t[11],r[0]=n,r[1]=o,r[2]=i,r[3]=a,r[4]=u,r[5]=s,r[6]=c,r[7]=f,r[8]=l,r[9]=d,r[10]=m,r[11]=h,r[12]=n*v+u*p+l*g+t[12],r[13]=o*v+s*p+d*g+t[13],r[14]=i*v+c*p+m*g+t[14],r[15]=a*v+f*p+h*g+t[15]),r}function p(r,t,e){var n=e[0],o=e[1],i=e[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*o,r[5]=t[5]*o,r[6]=t[6]*o,r[7]=t[7]*o,r[8]=t[8]*i,r[9]=t[9]*i,r[10]=t[10]*i,r[11]=t[11]*i,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function g(r,t,e,o){var i,a,u,s,c,f,l,d,m,h,v,p,g,M,b,T,w,x,E,_,R,y,P,C,F=o[0],A=o[1],L=o[2],S=Math.sqrt(F*F+A*A+L*L);return S<n.b?null:(F*=S=1/S,A*=S,L*=S,i=Math.sin(e),u=1-(a=Math.cos(e)),s=t[0],c=t[1],f=t[2],l=t[3],d=t[4],m=t[5],h=t[6],v=t[7],p=t[8],g=t[9],M=t[10],b=t[11],T=F*F*u+a,w=A*F*u+L*i,x=L*F*u-A*i,E=F*A*u-L*i,_=A*A*u+a,R=L*A*u+F*i,y=F*L*u+A*i,P=A*L*u-F*i,C=L*L*u+a,r[0]=s*T+d*w+p*x,r[1]=c*T+m*w+g*x,r[2]=f*T+h*w+M*x,r[3]=l*T+v*w+b*x,r[4]=s*E+d*_+p*R,r[5]=c*E+m*_+g*R,r[6]=f*E+h*_+M*R,r[7]=l*E+v*_+b*R,r[8]=s*y+d*P+p*C,r[9]=c*y+m*P+g*C,r[10]=f*y+h*P+M*C,r[11]=l*y+v*P+b*C,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function M(r,t,e){var n=Math.sin(e),o=Math.cos(e),i=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],d=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=i*o+c*n,r[5]=a*o+f*n,r[6]=u*o+l*n,r[7]=s*o+d*n,r[8]=c*o-i*n,r[9]=f*o-a*n,r[10]=l*o-u*n,r[11]=d*o-s*n,r}function b(r,t,e){var n=Math.sin(e),o=Math.cos(e),i=t[0],a=t[1],u=t[2],s=t[3],c=t[8],f=t[9],l=t[10],d=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=i*o-c*n,r[1]=a*o-f*n,r[2]=u*o-l*n,r[3]=s*o-d*n,r[8]=i*n+c*o,r[9]=a*n+f*o,r[10]=u*n+l*o,r[11]=s*n+d*o,r}function T(r,t,e){var n=Math.sin(e),o=Math.cos(e),i=t[0],a=t[1],u=t[2],s=t[3],c=t[4],f=t[5],l=t[6],d=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=i*o+c*n,r[1]=a*o+f*n,r[2]=u*o+l*n,r[3]=s*o+d*n,r[4]=c*o-i*n,r[5]=f*o-a*n,r[6]=l*o-u*n,r[7]=d*o-s*n,r}function w(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function x(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function E(r,t,e){var o,i,a,u=e[0],s=e[1],c=e[2],f=Math.sqrt(u*u+s*s+c*c);return f<n.b?null:(u*=f=1/f,s*=f,c*=f,o=Math.sin(t),a=1-(i=Math.cos(t)),r[0]=u*u*a+i,r[1]=s*u*a+c*o,r[2]=c*u*a-s*o,r[3]=0,r[4]=u*s*a-c*o,r[5]=s*s*a+i,r[6]=c*s*a+u*o,r[7]=0,r[8]=u*c*a+s*o,r[9]=s*c*a-u*o,r[10]=c*c*a+i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function _(r,t){var e=Math.sin(t),n=Math.cos(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=e,r[7]=0,r[8]=0,r[9]=-e,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function R(r,t){var e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=0,r[2]=-e,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=e,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function y(r,t){var e=Math.sin(t),n=Math.cos(t);return r[0]=n,r[1]=e,r[2]=0,r[3]=0,r[4]=-e,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function P(r,t,e){var n=t[0],o=t[1],i=t[2],a=t[3],u=n+n,s=o+o,c=i+i,f=n*u,l=n*s,d=n*c,m=o*s,h=o*c,v=i*c,p=a*u,g=a*s,M=a*c;return r[0]=1-(m+v),r[1]=l+M,r[2]=d-g,r[3]=0,r[4]=l-M,r[5]=1-(f+v),r[6]=h+p,r[7]=0,r[8]=d+g,r[9]=h-p,r[10]=1-(f+m),r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function C(r,t){var e=new n.a(3),o=-t[0],i=-t[1],a=-t[2],u=t[3],s=t[4],c=t[5],f=t[6],l=t[7],d=o*o+i*i+a*a+u*u;return d>0?(e[0]=2*(s*u+l*o+c*a-f*i)/d,e[1]=2*(c*u+l*i+f*o-s*a)/d,e[2]=2*(f*u+l*a+s*i-c*o)/d):(e[0]=2*(s*u+l*o+c*a-f*i),e[1]=2*(c*u+l*i+f*o-s*a),e[2]=2*(f*u+l*a+s*i-c*o)),P(r,t,e),r}function F(r,t){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r}function A(r,t){var e=t[0],n=t[1],o=t[2],i=t[4],a=t[5],u=t[6],s=t[8],c=t[9],f=t[10];return r[0]=Math.sqrt(e*e+n*n+o*o),r[1]=Math.sqrt(i*i+a*a+u*u),r[2]=Math.sqrt(s*s+c*c+f*f),r}function L(r,t){var e=t[0]+t[5]+t[10],n=0;return e>0?(n=2*Math.sqrt(e+1),r[3]=.25*n,r[0]=(t[6]-t[9])/n,r[1]=(t[8]-t[2])/n,r[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),r[3]=(t[6]-t[9])/n,r[0]=.25*n,r[1]=(t[1]+t[4])/n,r[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),r[3]=(t[8]-t[2])/n,r[0]=(t[1]+t[4])/n,r[1]=.25*n,r[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),r[3]=(t[1]-t[4])/n,r[0]=(t[8]+t[2])/n,r[1]=(t[6]+t[9])/n,r[2]=.25*n),r}function S(r,t,e,n){var o=t[0],i=t[1],a=t[2],u=t[3],s=o+o,c=i+i,f=a+a,l=o*s,d=o*c,m=o*f,h=i*c,v=i*f,p=a*f,g=u*s,M=u*c,b=u*f,T=n[0],w=n[1],x=n[2];return r[0]=(1-(h+p))*T,r[1]=(d+b)*T,r[2]=(m-M)*T,r[3]=0,r[4]=(d-b)*w,r[5]=(1-(l+p))*w,r[6]=(v+g)*w,r[7]=0,r[8]=(m+M)*x,r[9]=(v-g)*x,r[10]=(1-(l+h))*x,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function D(r,t,e,n,o){var i=t[0],a=t[1],u=t[2],s=t[3],c=i+i,f=a+a,l=u+u,d=i*c,m=i*f,h=i*l,v=a*f,p=a*l,g=u*l,M=s*c,b=s*f,T=s*l,w=n[0],x=n[1],E=n[2],_=o[0],R=o[1],y=o[2],P=(1-(v+g))*w,C=(m+T)*w,F=(h-b)*w,A=(m-T)*x,L=(1-(d+g))*x,S=(p+M)*x,D=(h+b)*E,U=(p-M)*E,B=(1-(d+v))*E;return r[0]=P,r[1]=C,r[2]=F,r[3]=0,r[4]=A,r[5]=L,r[6]=S,r[7]=0,r[8]=D,r[9]=U,r[10]=B,r[11]=0,r[12]=e[0]+_-(P*_+A*R+D*y),r[13]=e[1]+R-(C*_+L*R+U*y),r[14]=e[2]+y-(F*_+S*R+B*y),r[15]=1,r}function U(r,t){var e=t[0],n=t[1],o=t[2],i=t[3],a=e+e,u=n+n,s=o+o,c=e*a,f=n*a,l=n*u,d=o*a,m=o*u,h=o*s,v=i*a,p=i*u,g=i*s;return r[0]=1-l-h,r[1]=f+g,r[2]=d-p,r[3]=0,r[4]=f-g,r[5]=1-c-h,r[6]=m+v,r[7]=0,r[8]=d+p,r[9]=m-v,r[10]=1-c-l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function B(r,t,e,n,o,i,a){var u=1/(e-t),s=1/(o-n),c=1/(i-a);return r[0]=2*i*u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*i*s,r[6]=0,r[7]=0,r[8]=(e+t)*u,r[9]=(o+n)*s,r[10]=(a+i)*c,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*i*2*c,r[15]=0,r}function I(r,t,e,n,o){var i,a=1/Math.tan(t/2);return r[0]=a/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=o&&o!==1/0?(i=1/(n-o),r[10]=(o+n)*i,r[14]=2*o*n*i):(r[10]=-1,r[14]=-2*n),r}function O(r,t,e,n){var o=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(o+i);return r[0]=s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=c,r[6]=0,r[7]=0,r[8]=-(a-u)*s*.5,r[9]=(o-i)*c*.5,r[10]=n/(e-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*e/(e-n),r[15]=0,r}function N(r,t,e,n,o,i,a){var u=1/(t-e),s=1/(n-o),c=1/(i-a);return r[0]=-2*u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*c,r[11]=0,r[12]=(t+e)*u,r[13]=(o+n)*s,r[14]=(a+i)*c,r[15]=1,r}function j(r,t,e,o){var i,a,u,s,f,l,d,m,h,v,p=t[0],g=t[1],M=t[2],b=o[0],T=o[1],w=o[2],x=e[0],E=e[1],_=e[2];return Math.abs(p-x)<n.b&&Math.abs(g-E)<n.b&&Math.abs(M-_)<n.b?c(r):(d=p-x,m=g-E,h=M-_,i=T*(h*=v=1/Math.sqrt(d*d+m*m+h*h))-w*(m*=v),a=w*(d*=v)-b*h,u=b*m-T*d,(v=Math.sqrt(i*i+a*a+u*u))?(i*=v=1/v,a*=v,u*=v):(i=0,a=0,u=0),s=m*u-h*a,f=h*i-d*u,l=d*a-m*i,(v=Math.sqrt(s*s+f*f+l*l))?(s*=v=1/v,f*=v,l*=v):(s=0,f=0,l=0),r[0]=i,r[1]=s,r[2]=d,r[3]=0,r[4]=a,r[5]=f,r[6]=m,r[7]=0,r[8]=u,r[9]=l,r[10]=h,r[11]=0,r[12]=-(i*p+a*g+u*M),r[13]=-(s*p+f*g+l*M),r[14]=-(d*p+m*g+h*M),r[15]=1,r)}function X(r,t,e,n){var o=t[0],i=t[1],a=t[2],u=n[0],s=n[1],c=n[2],f=o-e[0],l=i-e[1],d=a-e[2],m=f*f+l*l+d*d;m>0&&(f*=m=1/Math.sqrt(m),l*=m,d*=m);var h=s*d-c*l,v=c*f-u*d,p=u*l-s*f;return(m=h*h+v*v+p*p)>0&&(h*=m=1/Math.sqrt(m),v*=m,p*=m),r[0]=h,r[1]=v,r[2]=p,r[3]=0,r[4]=l*p-d*v,r[5]=d*h-f*p,r[6]=f*v-l*h,r[7]=0,r[8]=f,r[9]=l,r[10]=d,r[11]=0,r[12]=o,r[13]=i,r[14]=a,r[15]=1,r}function q(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function V(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+Math.pow(r[6],2)+Math.pow(r[7],2)+Math.pow(r[8],2)+Math.pow(r[9],2)+Math.pow(r[10],2)+Math.pow(r[11],2)+Math.pow(r[12],2)+Math.pow(r[13],2)+Math.pow(r[14],2)+Math.pow(r[15],2))}function z(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r[3]=t[3]+e[3],r[4]=t[4]+e[4],r[5]=t[5]+e[5],r[6]=t[6]+e[6],r[7]=t[7]+e[7],r[8]=t[8]+e[8],r[9]=t[9]+e[9],r[10]=t[10]+e[10],r[11]=t[11]+e[11],r[12]=t[12]+e[12],r[13]=t[13]+e[13],r[14]=t[14]+e[14],r[15]=t[15]+e[15],r}function k(r,t,e){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r[3]=t[3]-e[3],r[4]=t[4]-e[4],r[5]=t[5]-e[5],r[6]=t[6]-e[6],r[7]=t[7]-e[7],r[8]=t[8]-e[8],r[9]=t[9]-e[9],r[10]=t[10]-e[10],r[11]=t[11]-e[11],r[12]=t[12]-e[12],r[13]=t[13]-e[13],r[14]=t[14]-e[14],r[15]=t[15]-e[15],r}function G(r,t,e){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r[3]=t[3]*e,r[4]=t[4]*e,r[5]=t[5]*e,r[6]=t[6]*e,r[7]=t[7]*e,r[8]=t[8]*e,r[9]=t[9]*e,r[10]=t[10]*e,r[11]=t[11]*e,r[12]=t[12]*e,r[13]=t[13]*e,r[14]=t[14]*e,r[15]=t[15]*e,r}function H(r,t,e,n){return r[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r[3]=t[3]+e[3]*n,r[4]=t[4]+e[4]*n,r[5]=t[5]+e[5]*n,r[6]=t[6]+e[6]*n,r[7]=t[7]+e[7]*n,r[8]=t[8]+e[8]*n,r[9]=t[9]+e[9]*n,r[10]=t[10]+e[10]*n,r[11]=t[11]+e[11]*n,r[12]=t[12]+e[12]*n,r[13]=t[13]+e[13]*n,r[14]=t[14]+e[14]*n,r[15]=t[15]+e[15]*n,r}function W(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]}function Y(r,t){var e=r[0],o=r[1],i=r[2],a=r[3],u=r[4],s=r[5],c=r[6],f=r[7],l=r[8],d=r[9],m=r[10],h=r[11],v=r[12],p=r[13],g=r[14],M=r[15],b=t[0],T=t[1],w=t[2],x=t[3],E=t[4],_=t[5],R=t[6],y=t[7],P=t[8],C=t[9],F=t[10],A=t[11],L=t[12],S=t[13],D=t[14],U=t[15];return Math.abs(e-b)<=n.b*Math.max(1,Math.abs(e),Math.abs(b))&&Math.abs(o-T)<=n.b*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(i-w)<=n.b*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-x)<=n.b*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(u-E)<=n.b*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(s-_)<=n.b*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(c-R)<=n.b*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(f-y)<=n.b*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(l-P)<=n.b*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(d-C)<=n.b*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(m-F)<=n.b*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(h-A)<=n.b*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(v-L)<=n.b*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(p-S)<=n.b*Math.max(1,Math.abs(p),Math.abs(S))&&Math.abs(g-D)<=n.b*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(M-U)<=n.b*Math.max(1,Math.abs(M),Math.abs(U))}var Z=h,Q=k},function(r,t){r.exports="attribute vec4 position;\r\nattribute vec3 normal;\r\nattribute vec4 colors;\r\n\r\nuniform mat4 view;\r\nuniform mat4 model;\r\nuniform mat4 projection;\r\nuniform vec3 directionalLightVector;\r\nuniform float clipZ;\r\nuniform float clipLevel;\r\n\r\nvarying highp vec3 vLighting;\r\nvarying lowp vec2 vTextureCoord;\r\nvarying lowp vec4 fragmentColor;\r\nvarying float shouldClip;\r\n\r\nvoid main() {\r\n  // light\r\n  //highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\r\n  highp vec3 ambientLight = vec3(0, 0, 0);\r\n  highp vec3 directionalLightColor = vec3(1, 1, 1);\r\n  highp vec3 directionalVector = normalize(directionalLightVector);\r\n\r\n  highp vec4 transformedNormal = vec4(normal, 1.0);\r\n  highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\r\n  vLighting = ambientLight + (directionalLightColor * directional);\r\n\r\n  gl_Position = projection * view * model * position;\r\n\r\n  fragmentColor = colors;\r\n  if (clipLevel == 1.0) {\r\n    shouldClip = position.z > clipZ ? 1.0 : 0.0;\r\n  } else if (clipLevel == -1.0) {\r\n    shouldClip = position.z < clipZ ? 1.0 : 0.0;\r\n  } else {\r\n    shouldClip = 0.0;\r\n  }\r\n}"},function(r,t){r.exports="varying highp vec3 vLighting;\r\nvarying highp float shouldClip;\r\nvarying lowp vec4 fragmentColor;\r\n\r\nconst lowp vec4 nothingColor = vec4(0.0, 0.0, 0.0, 0.0);\r\nconst lowp vec4 grassColor = vec4(0.12, 0.43, 0.02, 1.0);\r\nconst lowp vec4 snowColor = vec4(1.0);\r\nconst lowp vec4 groundColor = vec4(0.85, 0.84, 0.79, 1.0);\r\n\r\nvoid main() {\r\n  if (shouldClip == 1.0) {\r\n    discard;\r\n  }\r\n  lowp float x = fragmentColor.x;\r\n  lowp float groundGrassMixFactor = smoothstep(0.1, 0.2, x);\r\n  lowp float grassSnowMixFactor = smoothstep(0.7, 0.8, x);\r\n  lowp float nothingGroundMixFactor = smoothstep(0.00, 0.015, x);\r\n  lowp vec4 color = mix(groundColor, grassColor, groundGrassMixFactor);\r\n  color = mix(color, snowColor, grassSnowMixFactor);\r\n  color = mix(nothingColor, color, nothingGroundMixFactor);\r\n\r\n  gl_FragColor = vec4(color.rgb * vLighting, color.a);\r\n}\r\n"},function(r,t){r.exports="attribute vec4 position;\r\nattribute vec2 textureCoord;\r\n\r\nuniform mat4 view;\r\nuniform mat4 model;\r\nuniform mat4 projection;\r\nuniform vec3 cameraPosition;\r\n\r\nvarying highp vec2 vTextureCoord;\r\nvarying highp vec4 clipSpace;\r\nvarying highp vec3 fromFragmentToCamera;\r\n\r\nconst lowp float tiling = 10.0;\r\n\r\nvoid main() {\r\n    vec4 worldPosition = model * position;\r\n    gl_Position = clipSpace = projection * view * worldPosition;\r\n\r\n    fromFragmentToCamera = cameraPosition - worldPosition.xyz;\r\n    vTextureCoord = textureCoord * tiling;\r\n}"},function(r,t){r.exports="varying lowp vec2 vTextureCoord;\r\nvarying lowp vec4 clipSpace;\r\nvarying lowp vec3 fromFragmentToCamera;\r\n\r\nuniform sampler2D dudvTexture;\r\nuniform sampler2D normalMapTexture;\r\nuniform sampler2D refractionTexture;\r\nuniform sampler2D reflectionTexture;\r\nuniform lowp float dudvOffset;\r\nuniform int useRefraction;\r\nuniform int useReflection;\r\nuniform lowp vec3 directionalLightVector;\r\n\r\nconst lowp float waterDistortionStrenth = 0.03;\r\nconst lowp float fresnelStrength = 1.5;\r\nconst lowp float waterReflectivity = 0.5;\r\nconst lowp vec3 sunlightColor = vec3(1.0, 1.0, 1.0);\r\nconst lowp vec4 shallowWaterColor =  vec4(0.0, 0.1, 0.3, 1.0);\r\n// const lowp vec4 deepWaterColor = vec4(0.0, 0.1, 0.2, 1.0);\r\nconst lowp float shineDamper = 20.0;\r\n\r\nvoid main() {\r\n    // distortion\r\n    lowp vec2 distortedTexCoords = texture2D(dudvTexture, vec2(vTextureCoord.x, vTextureCoord.y + dudvOffset)).xy * 0.1;\r\n    distortedTexCoords = vTextureCoord + vec2(distortedTexCoords.x + dudvOffset, distortedTexCoords.y);\r\n\r\n    lowp vec2 totalDistortion = (texture2D(dudvTexture, distortedTexCoords).xy * 2.0 - 1.0) * waterDistortionStrenth;\r\n\r\n    // base refract/reflect texture coordinates\r\n    lowp vec2 ndc = (clipSpace.xy / clipSpace.w) / 2.0 + 0.5;\r\n    lowp vec2 refractTexCoords = vec2(ndc.x, +ndc.y);\r\n    lowp vec2 reflectTexCoords = vec2(ndc.x, 1.0-ndc.y);\r\n\r\n    // refractive factor\r\n    lowp vec3 toCamera = normalize(fromFragmentToCamera);\r\n    lowp vec4 normalMapColor = texture2D(normalMapTexture, distortedTexCoords);\r\n    lowp vec3 normal = vec3(\r\n      normalMapColor.r * 2.0 - 1.0,\r\n      normalMapColor.g * 2.0 - 1.0,\r\n      normalMapColor.b * 2.0 - 1.0\r\n    );\r\n    normal = normalize(normal);\r\n    lowp float refractiveFactor = dot(toCamera, normal);\r\n    refractiveFactor = pow(refractiveFactor, fresnelStrength);\r\n\r\n    // puting all together\r\n    refractTexCoords += totalDistortion;\r\n    reflectTexCoords += totalDistortion;\r\n    // refractTexCoords = clamp(refractTexCoords, 0.001, 0.999);\r\n    // reflectTexCoords.x = clamp(reflectTexCoords.x, 0.001, 0.999);\r\n    // reflectTexCoords.y = clamp(reflectTexCoords.y, -0.999, -0.001);\r\n\r\n    // lighs\r\n    lowp vec3 reflectedLight = reflect(normalize(directionalLightVector), normal);\r\n    lowp float specular = max(dot(reflectedLight, toCamera), 0.0);\r\n    specular = pow(specular, shineDamper);\r\n    lowp vec3 specularHighlights = sunlightColor * specular * waterReflectivity;\r\n\r\n    // color\r\n    lowp vec4 refractColor = texture2D(refractionTexture, refractTexCoords);\r\n    lowp vec4 reflectColor = texture2D(reflectionTexture, reflectTexCoords);\r\n\r\n    if (useReflection == 1 && useRefraction == 1) {\r\n      gl_FragColor = mix(reflectColor, refractColor, refractiveFactor);\r\n    } else if (useReflection == 1) {\r\n      gl_FragColor = reflectColor;\r\n    } else if (useRefraction == 1) {\r\n      gl_FragColor = refractColor;\r\n    }\r\n    gl_FragColor = mix(gl_FragColor, shallowWaterColor, 0.2);\r\n\r\n    gl_FragColor = gl_FragColor + vec4(specularHighlights, 0.0);\r\n}\r\n"},function(r,t){r.exports="attribute vec4 position;\r\n\r\nuniform lowp mat4 view;\r\nuniform lowp mat4 model;\r\nuniform lowp mat4 projection;\r\n\r\nvarying lowp vec4 worldPosition;\r\n\r\nvoid main() {\r\n    worldPosition = model * position;\r\n    gl_Position = projection * view * worldPosition;\r\n}"},function(r,t){r.exports="uniform lowp float domeRadius;\r\nuniform lowp vec3 sunPosition;\r\n\r\nvarying lowp vec4 worldPosition;\r\n\r\nconst lowp float PI = 3.1415926535897932384626433832795;\r\nconst lowp float PI_2 = 1.57079632679489661923;\r\nconst lowp vec4 daySkyColor = vec4(0.67, 0.96, 0.98, 1.00);\r\nconst lowp vec4 nigthSkyColor = vec4(0.0, 0.0, 0.0, 1.0);\r\nconst lowp vec4 sunColorInner = vec4(0.89, 0.40, 0.00, 1.00);\r\nconst lowp vec4 sunColorOuter = vec4(0.95, 0.77, 0.35, 1.00);\r\n\r\n\r\nvoid main() {\r\n    lowp float sunSize = 0.1 * 700.0;\r\n    lowp float sunToFragment = distance(sunPosition * domeRadius, worldPosition.xyz);\r\n    lowp float colorFactor = smoothstep(0.0, sunSize, pow(sunToFragment, 1.0));\r\n    lowp float alpha = 0.5 - atan((sunToFragment - sunSize) / domeRadius) / PI;\r\n    lowp vec4 skyColor = mix(\r\n        daySkyColor,\r\n        nigthSkyColor,\r\n        smoothstep(1.0, 0.0, sunPosition.z)\r\n    );\r\n\r\n    lowp vec4 sunColor = mix(sunColorInner, sunColorOuter, colorFactor);\r\n\r\n    gl_FragColor = mix(skyColor, sunColor, alpha);\r\n}"},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e(1);t.createTerrain=async function(r,t,e){const o=document.createElement("canvas"),i=await function(r){return new Promise((t,e)=>{const n=new Image;n.src=r,n.onload=(()=>t(n)),n.onerror=e})}(r);o.width=i.width,o.height=i.height;const a=o.getContext("2d");if(!a)return;a.drawImage(i,0,0);const{data:u}=a.getImageData(0,0,i.width,i.height),s=new Uint32Array(u),c=256/t,f=Math.floor(i.width/e),l=Math.floor(i.height/e),d=new Float32Array(f*l);let m=0;for(let r=0;r<l;r++)for(let t=0;t<f;t++){let n=0;for(let o=0;o<e;o++)for(let a=0;a<e;a++)n+=s[4*(r*e*i.width+t*e+o*e+a)];const o=n/e/e/c;d[r*f+t]=o,m<o&&(m=o)}const h=[],v=[],p=[],g=[],M=[];for(let r=0;r<l;r++)for(let t=0;t<f;t++){const e=r*f+t,n=d[e]/m;h.push(t-f/2,r-l/2,d[e]),p.push(n,n,n,1),r!==l-1&&t!==f-1&&v.push(e,e+f,e+1,e+1,e+f,e+f+1),M.push(t/f,r/l)}for(let r=0;r<h.length/3;r++){const t=f,e=l,o=r%t,i=~~(r/t),a=[o>0&&i>0&&[r-t,r-1,r],o+1<t&&i>0&&[r-t,r,r-t+1],o+1<t&&i>0&&[r-t+1,r,r+1],o>0&&i<e&&[r-1,r+t-1,r],o>0&&i<e&&[r,r+t-1,r+t],o+1<t&&i<e&&[r,r+t,r+1]],u=[],s=[];for(let r=0;r<a.length;r++){const t=a[r];for(let r=0;r<3;r++)t&&u.push(h[3*t[r]],h[3*t[r]+1],h[3*t[r]+2])}for(let r=0;r<u.length/9;r++){const t=n.fromValues(u[9*r+0],u[9*r+1],u[9*r+2]),e=n.fromValues(u[9*r+3],u[9*r+4],u[9*r+5]),o=n.fromValues(u[9*r+6],u[9*r+7],u[9*r+8]);n.subtract(e,e,t),n.subtract(o,o,t),n.cross(e,e,o),n.normalize(e,e),s.push(e)}const c=n.fromValues(0,0,0);for(let r=0;r<s.length;r++)n.add(c,c,s[r]);n.normalize(c,c),g.push(c[0],c[1],c[2])}return{position:h,indices:v,colors:p,normals:g,texture:M}}},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e(12);t.initControls=function(r){let t=!1;const e=new n.EventEmitter,o={},i=()=>{let r=0,t=0;o.w&&!o.s?t=1:o.s&&!o.w&&(t=-1),o.a&&!o.d?r=-1:o.d&&!o.a&&(r=1),(r||t)&&e.emit("moveCamera",{dx:r,dy:t}),requestAnimationFrame(i)};return i(),r.addEventListener("wheel",r=>{const{deltaY:t}=r;t&&(e.emit("zoom",{dy:t/Math.abs(t)*10}),r.preventDefault())}),window.addEventListener("keypress",r=>{switch(r.key){case"1":e.emit("toggleRenderTerrain");break;case"2":e.emit("toggleRenderWater");break;case"3":e.emit("toggleRefraction");break;case"4":e.emit("toggleReflection");break;case"5":e.emit("toggleRenderSun");break;default:o[r.key]=!0}}),window.addEventListener("keyup",r=>{o[r.key]=!1}),r.addEventListener("mousedown",()=>{t=!0}),window.addEventListener("mouseup",()=>{t=!1}),window.addEventListener("mousemove",r=>{const{movementX:n,movementY:o}=r;t&&e.emit("moveCamera",{dx:-n,dy:o})}),e}},function(r,t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(r){return"function"==typeof r}function o(r){return"object"==typeof r&&null!==r}function i(r){return void 0===r}r.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(r){if("number"!=typeof r||r<0||isNaN(r))throw TypeError("n must be a positive number");return this._maxListeners=r,this},e.prototype.emit=function(r){var t,e,a,u,s,c;if(this._events||(this._events={}),"error"===r&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(i(e=this._events[r]))return!1;if(n(e))switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),e.apply(this,u)}else if(o(e))for(u=Array.prototype.slice.call(arguments,1),a=(c=e.slice()).length,s=0;s<a;s++)c[s].apply(this,u);return!0},e.prototype.addListener=function(r,t){var a;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",r,n(t.listener)?t.listener:t),this._events[r]?o(this._events[r])?this._events[r].push(t):this._events[r]=[this._events[r],t]:this._events[r]=t,o(this._events[r])&&!this._events[r].warned&&(a=i(this._maxListeners)?e.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[r].length>a&&(this._events[r].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[r].length),"function"==typeof console.trace&&console.trace()),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(r,t){if(!n(t))throw TypeError("listener must be a function");var e=!1;function o(){this.removeListener(r,o),e||(e=!0,t.apply(this,arguments))}return o.listener=t,this.on(r,o),this},e.prototype.removeListener=function(r,t){var e,i,a,u;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[r])return this;if(a=(e=this._events[r]).length,i=-1,e===t||n(e.listener)&&e.listener===t)delete this._events[r],this._events.removeListener&&this.emit("removeListener",r,t);else if(o(e)){for(u=a;u-- >0;)if(e[u]===t||e[u].listener&&e[u].listener===t){i=u;break}if(i<0)return this;1===e.length?(e.length=0,delete this._events[r]):e.splice(i,1),this._events.removeListener&&this.emit("removeListener",r,t)}return this},e.prototype.removeAllListeners=function(r){var t,e;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[r]&&delete this._events[r],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(e=this._events[r]))this.removeListener(r,e);else if(e)for(;e.length;)this.removeListener(r,e[e.length-1]);return delete this._events[r],this},e.prototype.listeners=function(r){return this._events&&this._events[r]?n(this._events[r])?[this._events[r]]:this._events[r].slice():[]},e.prototype.listenerCount=function(r){if(this._events){var t=this._events[r];if(n(t))return 1;if(t)return t.length}return 0},e.listenerCount=function(r,t){return r.listenerCount(t)}},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWater=function(){return{position:[-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,.5,0],indices:[0,2,1,1,2,3],texture:[0,0,1,0,0,1,1,1]}}},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e(1),{cos:o,sin:i,tan:a,PI:u}=Math;t.createSun=function(){const r=50,t=[],e=[];for(let n=0;n<=r;n++){const a=u/r*n-u/2;for(let s=0;s<r;s++){const c=2*u/r*s,f=o(c)*o(a),l=i(c)*o(a),d=i(a),m=n*r+s;t.push(f,l,d),n!==r&&(49===s?e.push(n*r,m+r,m,m+r,m+1,n*r):e.push(m,m+1,m+r,m+1,m+r,m+r+1))}}return{position:t,indices:e}};const s=.002;t.getSunPosition=function(r){const t=r*s%24*3600*1e3,e=Math.ceil(t/60/1e3),u=e%60,c=Math.floor(e/60),f=function(r){return a(-4.83049e-16*r*r+4.21414e-8*r-.420437)}(t)/2,l=function(r){return 7.344052639206152e-8*r-.1829595519336553}(t),d=o(f)*o(l),m=o(f)*i(l),h=i(f);return{sunTime:`${c}:${u}`,altitude:f,azimuth:l,sunPosition:n.fromValues(d,-m,h)}}},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e(1),o={center:n.fromValues(0,0,0),cameraPosition:n.fromValues(678,115,69),directionalLightVector:n.fromValues(0,0,-1),sunPosition:n.fromValues(0,0,-1),start:Date.now(),time:0,renderWater:!0,renderTerrain:!0,useReflection:!0,useRefraction:!0,renderSun:!0},i="wp-program-params",a=r=>Array.from(r).map(r=>{return(r>0?"+":"-")+Math.abs(r).toFixed(1)}).join(", ");t.initProperties=function(){const r=localStorage.getItem(i),t=r?JSON.parse(r):o;return Object.assign({},t,{start:Date.now()})},t.saveProperties=function(r){const t=Object.assign({},r,{center:Array.from(r.center),cameraPosition:Array.from(r.cameraPosition)});localStorage.setItem(i,JSON.stringify(t))},t.renderProperties=function(r,t){const e=[{title:"sun position",value:a(t.sunPosition)},{title:"sun time",value:t.sunTime},{title:"altitude",value:(180*t.altitude/Math.PI).toFixed(2)},{title:"azimuth",value:(180*t.azimuth/Math.PI).toFixed(2)},{title:"camera",control:"a d w s wheel mouse",value:a(t.cameraPosition)},{title:"terrain",control:"1",value:t.renderTerrain},{title:"water",control:"2",value:t.renderWater},{title:"use refraction",control:"3",value:t.useRefraction},{title:"use reflection",control:"4",value:t.useReflection},{title:"render sun disk",control:"5",value:t.renderSun}],n=["title","control","value"],o=r.querySelector("tbody");o.innerHTML="",e.forEach(r=>{const t=document.createElement("tr");n.forEach(e=>{const n=document.createElement("td");n.innerText=e in r?r[e]:"",t.appendChild(n)}),o.appendChild(t)})}},function(r,t,e){"use strict";function n(r,t,e){const n=r.createShader(t);return n?(r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS)?n:(console.warn(r.getShaderInfoLog(n)),console.warn(e),r.deleteShader(n),null)):null}Object.defineProperty(t,"__esModule",{value:!0}),t.loadTexture=async function(r,t){const e=await new Promise((r,e)=>{const n=new Image;n.src=t,n.onload=(()=>r(n)),n.onerror=e}),n=r.createTexture(),o=r=>0==(r&r-1);return r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),o(e.width)&&o(e.height)?r.generateMipmap(r.TEXTURE_2D):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)),n},t.createProgram=function(r,t,e){const o=n(r,r.VERTEX_SHADER,t),i=n(r,r.FRAGMENT_SHADER,e),a=r.createProgram();if(!a||!o||!i)return console.warn("Failed to create shader program"),null;if(r.attachShader(a,o),r.attachShader(a,i),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))return console.warn(r.getProgramInfoLog(a)),null;const u={},s={},c=r.getProgramParameter(a,r.ACTIVE_ATTRIBUTES),f=r.getProgramParameter(a,r.ACTIVE_UNIFORMS);for(let t=0;t<c;t++){const e=r.getActiveAttrib(a,t).name;u[e]=r.getAttribLocation(a,e)}for(let t=0;t<f;t++){const e=r.getActiveUniform(a,t).name;s[e]=r.getUniformLocation(a,e)}return{program:a,uniforms:s,attributes:u,gl:r}},t.createBuffer=function(r,t,e){const n=r.createBuffer();return r.bindBuffer(t,n),r.bufferData(t,e,r.STATIC_DRAW),n},t.bindBuffer=function(r,t,e,n){r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(e,n,r.FLOAT,!1,0,0),r.enableVertexAttribArray(e)},t.createFramebufferAndTexture=function(r,t,e){const n=r.createTexture(),o=r.createFramebuffer(),i=r.createRenderbuffer();return r.bindFramebuffer(r.FRAMEBUFFER,o),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.bindRenderbuffer(r.RENDERBUFFER,i),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,t,e),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,i),r.bindFramebuffer(r.FRAMEBUFFER,null),[n,o]},t.inRange=function(r,t,e){return r<t?t:r>e?e:r}}]);
//# sourceMappingURL=index.js.map